<!DOCTYPE html>
<html>
<head>
    <title>üéì Chemistry Paper Evaluator v2.3 - Predatory Penalty</title>
    <style>
        * { box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Arial, sans-serif; 
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); 
            margin: 0; padding: 20px; 
        }
        header { 
            background: linear-gradient(90deg, #1f3c88, #2a5298); 
            color: white; padding: 25px; 
            text-align: center; 
            border-radius: 15px; 
            box-shadow: 0 8px 32px rgba(31,60,136,0.3); 
        }
        .container { 
            max-width: 1100px; 
            margin: 30px auto; 
            background: white; 
            padding: 35px; 
            border-radius: 15px; 
            box-shadow: 0 10px 40px rgba(0,0,0,0.1); 
        }
        h1 { margin: 0; font-size: 2.2em; }
        h2 { 
            color: #1f3c88; 
            border-bottom: 3px solid #e8f0fe; 
            padding-bottom: 10px; 
        }
        #pdfUploadArea { 
            border: 3px dashed #1f3c88; 
            border-radius: 10px; 
            padding: 30px; 
            text-align: center; 
            background: #f8faff; 
            margin: 20px 0; 
            transition: all 0.3s; 
            cursor: pointer;
        }
        #pdfUploadArea:hover, #pdfUploadArea.dragover { 
            background: #e8f0fe; 
            border-color: #163172;
        }
        #fileInput { display: none; }
        .main-button { 
            background: linear-gradient(90deg, #1f3c88, #2a5298); 
            color: white; 
            padding: 15px 30px; 
            border: none; 
            border-radius: 10px; 
            cursor: pointer; 
            font-size: 16px; 
            font-weight: bold; 
            width: 100%; 
            margin: 20px 0;
        }
        .main-button:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 5px 15px rgba(31,60,136,0.4); 
        }
        .main-button:disabled { 
            opacity: 0.6; 
            cursor: not-allowed; 
            transform: none;
        }
        #status { 
            margin: 20px 0; 
            padding: 15px; 
            border-radius: 10px; 
            font-weight: bold; 
            font-size: 16px; 
            display: none;
        }
        .status-loading { background: #fff3cd; border-left: 5px solid #ffc107; }
        .status-success { background: #d4edda; border-left: 5px solid #28a745; }
        .status-error { background: #f8d7da; border-left: 5px solid #dc3545; }
        table { 
            width: 100%; 
            border-collapse: collapse; 
            margin: 20px 0; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); 
        }
        th, td { 
            padding: 15px; 
            text-align: left; 
            border-bottom: 1px solid #eee; 
        }
        th { 
            background: linear-gradient(90deg, #1f3c88, #2a5298); 
            color: white; 
            font-weight: bold; 
        }
        .score-excellent { background: linear-gradient(90deg, #d4edda, #c3e6cb); }
        .score-good { background: linear-gradient(90deg, #fff3cd, #ffeaa7); }
        .score-poor { background: linear-gradient(90deg, #f8d7da, #f7b7b7); }
        .journal-elite { background: linear-gradient(90deg, #28a745, #20c997) !important; color: white; font-weight: bold; }
        .journal-predatory { background: linear-gradient(90deg, #dc3545, #fd7e14) !important; color: white; font-weight: bold; }
        .comments { 
            background: #f8f9ff; 
            padding: 20px; 
            border-radius: 10px; 
            border-left: 5px solid #1f3c88; 
            margin: 20px 0; 
        }
        #result { display: none; }
        footer { 
            text-align: center; 
            padding: 25px; 
            color: #666; 
            font-size: 14px; 
        }
    </style>
</head>
<body>

<header>
    <h1>üéì Chemistry Paper Evaluator v2.3</h1>
    <p>üÜï Predatory Penalty | 120 Points | MSc Research</p>
</header>

<div class="container">
    <h2>üì§ Upload Chemistry Journal Paper</h2>
    
    <div id="pdfUploadArea" onclick="document.getElementById('fileInput').click()">
        <p>üñ±Ô∏è Click or drag searchable PDF here</p>
        <p style="font-size: 14px; color: #666; margin-top: 10px;">
            Scopus/SciFinder PDFs work best (Ctrl+A selects text inside)
        </p>
        <input type="file" id="fileInput" accept="application/pdf">
        <div id="fileNameDisplay"></div>
    </div>
    
    <button class="main-button" id="evaluateBtn" onclick="evaluatePaper()">
        üöÄ Run Comprehensive Academic Evaluation
    </button>
    
    <div id="status"></div>
    <div id="result"></div>
</div>

<footer>¬© 2026 | MSc Chemistry Research Toolkit | v2.3</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<script>
    // ‚úÖ Worker setup
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    
    // üÜï EXPANDED PREDATORY DATABASE (0-1 pt only)
    const PREDATORY_JOURNALS = [
        'international journal of modern chemistry', 'open journal of chemical sciences',
        'world journal of chemistry research', 'international journals', 'ijirt', 'ijrar',
        'impactfactor', 'sjif', 'cosmos', 'conferenceworld', 'biomed', 'scitechnol',
        'omkarcollege', 'jets', 'irjp', 'modern chemistry', 'open chemistry',
        'global journal of chemistry', 'american journal of chemistry',rasayan j chem
    ];
    
    // STANDARD PUBLISHERS (12-15 pts)
    const STANDARD_PUBLISHERS = [
        'springer', 'wiley', 'elsevier', 'acs', 'rsc', 'nature', 'cell'
    ];
    
    // Drag & drop handlers (unchanged)
    const uploadArea = document.getElementById('pdfUploadArea');
    const fileInput = document.getElementById('fileInput');
    const fileNameDisplay = document.getElementById('fileNameDisplay');
    
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        uploadArea.addEventListener(eventName, preventDefaults, false);
    });
    
    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }
    
    ['dragenter', 'dragover'].forEach(eventName => {
        uploadArea.addEventListener(eventName, highlight, false);
    });
    
    ['dragleave', 'drop'].forEach(eventName => {
        uploadArea.addEventListener(eventName, unhighlight, false);
    });
    
    function highlight(e) {
        uploadArea.classList.add('dragover');
    }
    
    function unhighlight(e) {
        uploadArea.classList.remove('dragover');
    }
    
    uploadArea.addEventListener('drop', handleDrop, false);
    
    function handleDrop(e) {
        const dt = e.dataTransfer;
        const files = dt.files;
        handleFiles(files);
    }
    
    fileInput.addEventListener('change', (e) => handleFiles(e.target.files));
    
    function handleFiles(files) {
        if (files.length > 0) {
            fileInput.files = files;
            fileNameDisplay.innerHTML = `<strong>‚úÖ ${files[0].name}</strong> (${(files[0].size/1024).toFixed(1)}KB)`;
            document.getElementById('evaluateBtn').disabled = false;
        }
    }
    
    // ‚úÖ MAIN EVALUATION WITH HARSH PREDATORY PENALTY
    async function evaluatePaper() {
        const file = fileInput.files[0];
        const status = document.getElementById('status');
        const result = document.getElementById('result');
        const evaluateBtn = document.getElementById('evaluateBtn');
        
        if (!file) {
            showStatus('‚ùå Please upload a PDF first', 'status-error');
            return;
        }
        
        evaluateBtn.disabled = true;
        evaluateBtn.textContent = '‚è≥ Analyzing...';
        result.style.display = 'none';
        showStatus('üìñ Extracting text from PDF...', 'status-loading');
        
        try {
            const arrayBuffer = await file.arrayBuffer();
            const loadingTask = pdfjsLib.getDocument(arrayBuffer);
            const pdf = await loadingTask.promise;
            
            let fullText = '';
            const maxPages = Math.min(15, pdf.numPages);
            
            showStatus(`üìÑ Processing ${maxPages}/${pdf.numPages} pages...`, 'status-loading');
            
            for (let i = 1; i <= maxPages; i++) {
                const page = await pdf.getPage(i);
                const textContent = await page.getTextContent();
                const pageText = textContent.items.map(item => item.str).join(' ');
                fullText += pageText + '\n';
            }
            
            if (fullText.trim().length < 200) {
                throw new Error('No extractable text found. Use searchable PDF.');
            }
            
            showStatus('üéØ Academic analysis + journal verification...', 'status-loading');
            
            const textLower = fullText.toLowerCase();
            const fileNameLower = file.name.toLowerCase();
            
            // ========== üÜï HARSH JOURNAL SCORING (15 pts MAX) ==========
            let journalScore = 0;
            let journalClass = 'score-poor';
            let journalStatus = 'Unknown';
            let isPredatory = false;
            
            // üî¥ PREDATORY/CLONED JOURNALS = 0-1 pt (SEVERE PENALTY)
            const predatoryMatch = PREDATORY_JOURNALS.some(journal => 
                fileNameLower.includes(journal.toLowerCase()) || 
                textLower.includes(journal.toLowerCase())
            );
            
            if (predatoryMatch) {
                journalScore = 1;  // MINIMAL SCORE
                journalClass = 'journal-predatory';
                journalStatus = 'üö® PREDATORY/CLONED JOURNAL';
                isPredatory = true;
            } 
            // üü¢ STANDARD/ELITE JOURNALS = 12-15 pts
            else if (STANDARD_PUBLISHERS.some(pub => 
                fileNameLower.includes(pub.toLowerCase()) || 
                textLower.includes(pub.toLowerCase()))) {
                journalScore = 15;
                journalClass = 'journal-elite';
                journalStatus = '‚úÖ ELITE PUBLISHER';
            }
            // üü° DOI + Reputable = 8-10 pts
            else if (fullText.match(/10\.[0-9]{4,}/)) {
                journalScore = 10;
                journalClass = 'score-excellent';
                journalStatus = '‚úÖ Reputable (DOI)';
            }
            else {
                journalScore = 5;
                journalStatus = '‚ö†Ô∏è Verify publisher';
            }
            
            // ========== CORE ACADEMIC SCORING ==========
            const refCount = (fullText.match(/\[[0-9]+\]/g) || []).length;
            const refScore = Math.min(12, Math.floor(refCount / 1.5));
            
            const imrad = {
                intro: textLower.includes('introduction'),
                methods: ['method', 'materials', 'procedure'].some(kw => textLower.includes(kw)),
                results: textLower.includes('results'),
                discussion: textLower.includes('discussion')
            };
            const imradScore = Object.values(imrad).filter(Boolean).length * 3;
            
            const absMatch = fullText.match(/abstract[:\s]*([\s\S]*?)(?=1\s+|introduction|\n[A-Z]{4,})/i);
            const absWords = absMatch ? absMatch[1].trim().split(/\s+/).length : 0;
            const absScore = absWords > 120 ? 12 : absWords > 80 ? 9 : absWords > 50 ? 6 : 0;
            
            const litKeywords = ['review', 'literature', 'previous', 'prior studies'];
            const litScore = Math.min(12, litKeywords.filter(kw => textLower.includes(kw)).length * 3);
            
            const chemMethods = ['uv-vis', 'xrd', 'ftir', 'nmr', 'sem', 'tem', 'tga', 'synthesis'];
            const methodScore = Math.min(15, chemMethods.filter(kw => textLower.includes(kw)).length * 2);
            
            const uniqueWords = new Set(fullText.split(/\W+/).filter(w => w.length > 4).map(w => w.toLowerCase()));
            const writingScore = Math.min(10, Math.floor(uniqueWords.size / 80));
            
            const orgKeywords = ['figure', 'table', 'scheme', 'equation'];
            const orgScore = Math.min(10, orgKeywords.filter(kw => textLower.includes(kw)).length * 2.5);
            
            const noveltyKeywords = ['novel', 'first', 'innovative', 'biochar', 'nanocomposite'];
            const noveltyScore = Math.min(12, noveltyKeywords.filter(kw => textLower.includes(kw)).length * 2);
            
            const hIndexScore = textLower.includes('h-index') || textLower.includes('scopus') || refCount > 25 ? 12 : 6;
            
            const totalScore = refScore + imradScore + absScore + litScore + methodScore + 
                             writingScore + orgScore + noveltyScore + journalScore + hIndexScore;
            
            // üÜï Comments - NO JOURNAL NAMES SHOWN
            const comments = [];
            if (isPredatory) {
                comments.unshift('üö® CRITICAL: Predatory journal detected - WITHDRAW IMMEDIATELY');
                comments.push('This publication will harm your academic profile');
            }
            if (journalScore >= 12) {
                comments.push('‚úÖ Excellent publisher selection');
            }
            
            comments.push(
                totalScore >= 100 ? 'üèÜ Outstanding manuscript quality' : 
                totalScore >= 85 ? '‚úÖ Excellent - minor revisions needed' : 
                totalScore >= 70 ? 'üìà Good quality paper' : '‚ö†Ô∏è Needs significant improvement'
            );
            
            if (methodScore < 10) comments.push('üî¨ Add detailed characterization techniques');
            
            showResult(totalScore, {
                refScore, imradScore, absScore, litScore, methodScore, 
                writingScore, orgScore, noveltyScore, journalScore, hIndexScore,
                journalStatus, journalClass, isPredatory,
                refCount, absWords, imrad, 
                chemMethods: chemMethods.filter(kw => textLower.includes(kw)).slice(0,3),
                uniqueWords: uniqueWords.size
            }, comments);
            
        } catch (error) {
            showStatus(`‚ùå Error: ${error.message}`, 'status-error');
            console.error('Evaluation error:', error);
        } finally {
            evaluateBtn.disabled = false;
            evaluateBtn.textContent = 'üöÄ Run Comprehensive Academic Evaluation';
        }
    }
    
    function showStatus(message, className) {
        const status = document.getElementById('status');
        status.textContent = message;
        status.className = className;
        status.style.display = 'block';
    }
    
    function showResult(totalScore, scores, comments) {
        const result = document.getElementById('result');
        result.innerHTML = `
            <h2>üìä Final Score: ${Math.round(totalScore)}/120</h2>
            <table>
                <tr><th>Criteria</th><th>Score</th><th>Max</th><th>Status</th></tr>
                <tr class="${scores.journalClass}">
                    <td>üèõÔ∏è Journal Quality</td><td>${scores.journalScore}</td><td>15</td><td>${scores.journalStatus}</td>
                </tr>
                <tr class="${totalScore>=100?'score-excellent':'score-good'}"><td>üìö Referencing</td><td>${scores.refScore}</td><td>12</td><td>${scores.refCount} citations</td></tr>
                <tr><td>üìë IMRAD Structure</td><td>${scores.imradScore}</td><td>12</td><td>Sections detected</td></tr>
                <tr><td>üìù Abstract</td><td>${scores.absScore}</td><td>12</td><td>${scores.absWords} words</td></tr>
                <tr><td>üìñ Literature Review</td><td>${scores.litScore}</td><td>12</td><td>Review indicators</td></tr>
                <tr class="${scores.methodScore>=12?'score-excellent':'score-good'}">
                    <td>üî¨ Chemistry Methods</td><td>${scores.methodScore}</td><td>15</td><td>${scores.chemMethods.join(', ') || 'None'}</td>
                </tr>
                <tr><td>‚úçÔ∏è Writing Quality</td><td>${scores.writingScore}</td><td>10</td><td>${scores.uniqueWords} unique words</td></tr>
                <tr><td>üìä Organization</td><td>${scores.orgScore}</td><td>10</td><td>Visual elements</td></tr>
                <tr><td>üí° Novelty</td><td>${scores.noveltyScore}</td><td>12</td><td>Innovation detected</td></tr>
                <tr><td>üìà H-Index Proxy</td><td>${scores.hIndexScore}</td><td>12</td><td>Author metrics</td></tr>
                <tr><th>TOTAL</th><th>${Math.round(totalScore)}</th><th>120</th>
                    <th>${totalScore>=100?'üéì Outstanding':totalScore>=85?'‚úÖ Excellent':'üìà Revise'}</th></tr>
            </table>
            <div class="comments">
                <h3>üí¨ Academic Assessment:</h3>
                ${comments.map(c => `<p>‚Ä¢ ${c}</p>`).join('')}
            </div>
        `;
        result.style.display = 'block';
        showStatus(`‚úÖ Complete! ${Math.round(totalScore)}/120`, 'status-success');
    }
</script>

</body>
</html>
