<!DOCTYPE html>
<html>
<head>
    <title>AI Research Paper Evaluator (100 pts)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.7.76/pdf.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; background: #f4f6f9; margin: 0; padding: 20px; }
        header { background: #1f3c88; color: white; padding: 20px; text-align: center; border-radius: 10px 10px 0 0; }
        .container { width: 90%; max-width: 1000px; margin: auto; background: white; padding: 30px; box-shadow: 0 0 20px rgba(0,0,0,0.1); border-radius: 0 0 10px 10px; }
        h2 { color: #1f3c88; }
        #pdfUpload { padding: 10px; border: 2px dashed #1f3c88; border-radius: 5px; width: 100%; margin: 10px 0; }
        button { background: #1f3c88; color: white; padding: 12px 24px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }
        button:hover { background: #163172; }
        #status { margin: 20px 0; padding: 10px; background: #e8f0fe; border-radius: 5px; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background: #1f3c88; color: white; }
        .good { background: #d4edda; }
        .warn { background: #fff3cd; }
        .bad { background: #f8d7da; }
        #result { display: none; }
        footer { text-align: center; padding: 20px; color: #666; }
    </style>
</head>
<body>
<header>
    <h1>üß™ AI Research Paper Evaluator</h1>
    <p>M.Sc Chemistry ‚Äì Auto-Scorecard /100 | Plagiarism + Novelty + H-Index Detection</p>
</header>

<div class="container">
    <h2>Upload Journal Paper (.pdf)</h2>
    <input type="file" id="pdfUpload" accept="application/pdf">
    <button onclick="evaluatePaper()">ü§ñ Evaluate Paper (100 pts)</button>
    
    <div id="status"></div>
    <div id="result"></div>
</div>

<footer>¬© 2026 Monika Kannan | Chemistry Research AI Evaluator</footer>

<script>
pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.7.76/pdf.worker.min.js';

async function evaluatePaper() {
    const fileInput = document.getElementById("pdfUpload");
    const file = fileInput.files[0];
    const status = document.getElementById("status");
    const result = document.getElementById("result");
    
    if (!file) return status.innerHTML = '<span style="color:red">‚ùå Upload PDF first</span>';
    
    status.innerHTML = 'üìÑ Extracting text...';
    result.style.display = 'none';
    
    try {
        const arrayBuffer = await file.arrayBuffer();
        const pdf = await pdfjsLib.getDocument(arrayBuffer).promise;
        let fullText = '';
        
        // Extract first 10 pages (fast)
        for (let i = 1; i <= Math.min(10, pdf.numPages); i++) {
            const page = await pdf.getPage(i);
            const textContent = await page.getTextContent();
            fullText += textContent.items.map(item => item.str).join(' ') + '\n';
        }
        
        const textLower = fullText.toLowerCase();
        status.innerHTML = 'ü§ñ AI Analyzing: Plagiarism/Novelty/Citations...';
        
        // ========== 100 PT SCORING ==========
        
        // 1. Abstract (15 pts)
        let abstractScore = 0;
        const absMatch = fullText.match(/abstract[:\s]*([\s\S]*?)(?=introduction|\n1\s|methods|\n\n[A-Z]{3,})/i);
        if (absMatch) {
            const absLen = absMatch[1].trim().split(/\s+/).length;
            abstractScore = absLen > 150 ? 15 : absLen > 100 ? 12 : 8;
        }
        
        // 2. Methodology (20 pts) - Chemistry keywords
        const methodKeywords = ['methodology', 'materials', 'synthesis', 'characterization', 'procedure', 'experiment', 'uv-vis', 'xrd', 'ftir', 'nmr'];
        const methodHits = methodKeywords.filter(kw => textLower.includes(kw)).length;
        let methodologyScore = Math.min(20, methodHits * 2);
        
        // 3. Citations (15 pts)
        const citations = (fullText.match(/\[[0-9,]+\]/g) || []).length + (fullText.match(/\(20[0-9]{2}\)/g) || []).length;
        let citationScore = Math.min(15, Math.floor(citations / 3));
        
        // 4. Novelty (20 pts) - Unique terms
        const noveltyKeywords = ['novel', 'first', 'innovative', 'new approach', 'unprecedented', 'nanocomposite', 'doped zno', 'biochar', 'electrocatalytic'];
        const noveltyHits = noveltyKeywords.filter(kw => textLower.includes(kw)).length;
        let noveltyScore = Math.min(20, noveltyHits * 2);
        
        // 5. Plagiarism Risk (15 pts) - Repetitive/simple text
        const uniqueWords = new Set(fullText.toLowerCase().split(/\W+/).filter(w => w.length > 4));
        const plagiarismRisk = Math.min(15, Math.floor((uniqueWords.size / 150) * 15)); // Diverse vocab = low risk
        
        // 6. Journal Quality (10 pts) - DOI + Filename
        let doiScore = 0;
        const doiMatch = fullText.match(/10\.[0-9]{4,}(?:\.[0-9]+)*/g) || file.name.match(/10\.[0-9]{4,}/);
        if (doiMatch) doiScore = 8;
        
        const journalName = file.name.toLowerCase();
        let journalScore = doiScore;
        if (/nature|science|acs|elsevier|rsc|wiley/i.test(journalName)) journalScore += 2;
        
        // 7. H-Index Proxy (5 pts) - Author prominence hints
        let hIndexScore = textLower.includes('h-index') || textLower.includes('citations') ? 5 : 0;
        
        const totalScore = abstractScore + methodologyScore + citationScore + noveltyScore + plagiarismRisk + journalScore + hIndexScore;
        
        // Color coding
        const getClass = (score, max) => {
            const pct = score / max * 100;
            if (pct >= 80) return 'good';
            if (pct >= 60) return 'warn';
            return 'bad';
        };
        
        result.innerHTML = `
            <h3>üìä AI Scorecard: ${Math.round(totalScore)} / 100</h3>
            <table>
                <tr><th>Criteria</th><th>Score</th><th>Max</th><th>Analysis</th></tr>
                <tr class="${getClass(abstractScore,15)}"><td>Abstract Strength</td><td>${abstractScore}</td><td>15</td><td>${absMatch ? `~${Math.round(absMatch[1].trim().split(/\s+/).length)} words` : 'Missing'}</td></tr>
                <tr class="${getClass(methodologyScore,20)}"><td>Methodology</td><td>${methodologyScore}</td><td>20</td><td>${methodHits} chem keywords (UV-Vis, XRD...)</td></tr>
                <tr class="${getClass(citationScore,15)}"><td>Citations</td><td>${citationScore}</td><td>15</td><td>${citations} detected</td></tr>
                <tr class="${getClass(noveltyScore,20)}"><td>Novelty</td><td>${noveltyScore}</td><td>20</td><td>${noveltyHits} unique terms</td></tr>
                <tr class="${getClass(plagiarismRisk,15)}"><td>Plagiarism Risk</td><td>${plagiarismRisk}</td><td>15</td><td>${uniqueWords.size} unique words (Low risk=High score)</td></tr>
                <tr class="${getClass(journalScore,10)}"><td>Journal Quality</td><td>${journalScore}</td><td>10</td><td>${doiMatch ? 'DOI Found' : 'No DOI'}</td></tr>
                <tr class="${getClass(hIndexScore,5)}"><td>H-Index Proxy</td><td>${hIndexScore}</td><td>5</td><td>${hIndexScore ? 'Author metrics mentioned' : 'Not found'}</td></tr>
                <tr><th>Total</th><th>${Math.round(totalScore)}</th><th>100</th><th>${totalScore >= 80 ? 'Excellent' : totalScore >= 60 ? 'Good' : 'Needs Work'}</th></tr>
            </table>
            <p><em>Analyzed first 10 pages | Chemistry-optimized (ZnO, biochar, spectroscopy) | Plagiarism via vocab diversity</em></p>
        `;
        result.style.display = 'block';
        status.innerHTML = '‚úÖ Complete!';
        
    } catch (error) {
        status.innerHTML = `<span style="color:red">‚ùå Error: ${error.message}<br>Try text PDF (not scanned). Check F12 console.</span>`;
        console.error(error);
    }
}
</script>
</body>
</html>
